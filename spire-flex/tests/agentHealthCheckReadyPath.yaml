suite: test .agent.healthCheck.readyPath /i_am_ready
set:
  Release.Name: devcluster
templates:
  - agent-configmap.yaml
tests:
  - it: should work
    set:
      agent.healthCheck.readyPath: "/i_am_ready"
    asserts:
      - containsDocument:
          apiVersion: "v1"
          kind: "ConfigMap"
          name: "RELEASE-NAME-agent-config"
          namespace: "NAMESPACE"
      - equal:
          path: data.agent_config
          value: |
            agent {
            }
            
            plugins {
            }
            
            health_checks {
              listener_enabled = true
              bind_address = "0.0.0.0"
              bind_port = 8080
              live_path = "/live"
              ready_path = "/i_am_ready"
            }
